# QMT-MCP æ¸¸èµ„æ‰“æ¿åŠ©æ‰‹ ğŸš€

[![Python](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

**æç®€æ¶æ„ï¼Œä¸“æ³¨æ¸¸èµ„æ‰“æ¿æ ¸å¿ƒåŠŸèƒ½**

ä¸€ä¸ªåŸºäº FastMCP å’Œ XTQuant çš„è½»é‡çº§é‡åŒ–äº¤æ˜“å·¥å…·ï¼Œä¸“ä¸ºæ¸¸èµ„æ‰“æ¿åœºæ™¯è®¾è®¡ã€‚æ‰€æœ‰ä»£ç æ•´åˆåœ¨å•ä¸ª `main.py` æ–‡ä»¶ä¸­ï¼Œç®€å•æ˜“ç”¨ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ“Š æ•°æ®åˆ†æ
- **æ¶¨åœæ¿ç»Ÿè®¡** - å®æ—¶å‘ç°æ¶¨åœè‚¡ç¥¨ï¼ŒæŒ‰æ¶¨å¹…æ’åº
- **æˆäº¤é‡å¼‚åŠ¨** - æ™ºèƒ½è¯†åˆ«é‡æ¯”å¼‚å¸¸è‚¡ç¥¨
- **é¾™è™æ¦œåˆ†æ** - åŸºäºæŠ€æœ¯æŒ‡æ ‡åˆ¤æ–­ä¸Šæ¦œå¯èƒ½æ€§
- **è‚¡ç¥¨ä¿¡æ¯æŸ¥è¯¢** - ä»·æ ¼ã€æˆäº¤é‡ã€å‡çº¿ç­‰å…¨é¢æ•°æ®

### ğŸ’° äº¤æ˜“åŠŸèƒ½
- **ä¸‹å•äº¤æ˜“** - æ”¯æŒä¹°å…¥/å–å‡ºï¼Œå¸¦é£æ§éªŒè¯
- **æ’¤å•æ“ä½œ** - å¿«é€Ÿæ’¤é”€æœªæˆäº¤è®¢å•
- **æ¨¡æ‹Ÿæ¨¡å¼** - æ— éœ€å®ç›˜å³å¯æµ‹è¯•åŠŸèƒ½

## ğŸ—ï¸ æç®€æ¶æ„

```
qmt-mcp/
â”œâ”€â”€ main.py              # å”¯ä¸€æºç æ–‡ä»¶ï¼ˆåŒ…å«æ‰€æœ‰åŠŸèƒ½ï¼‰
â”œâ”€â”€ .env.example         # é…ç½®æ¨¡æ¿
â”œâ”€â”€ requirements.txt     # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ README.md           # æœ¬æ–‡æ¡£
â””â”€â”€ logs/               # æ—¥å¿—ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
```

**æ‰€æœ‰åŠŸèƒ½éƒ½åœ¨ `main.py` ä¸­ï¼š**
- é…ç½®ç®¡ç†
- XTQuant å®¢æˆ·ç«¯
- äº¤æ˜“å·¥å…·
- æ•°æ®åˆ†æå™¨
- MCP æœåŠ¡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ ç¯å¢ƒè¦æ±‚

- Python 3.8+
- Windows ç³»ç»Ÿï¼ˆXTQuant è¦æ±‚ï¼‰
- å›½é‡‘QMT / è¿…æŠ•é‡åŒ–å®¢æˆ·ç«¯

### 2ï¸âƒ£ å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/stdeson/QMT-MCP.git
cd QMT-MCP

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒ
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ QMT è·¯å¾„å’Œè´¦æˆ·ä¿¡æ¯
```

### 3ï¸âƒ£ é…ç½® .env æ–‡ä»¶

```env
# æœåŠ¡å™¨
QMT_PORT=8000
QMT_PATH=D:\å›½é‡‘QMTäº¤æ˜“ç«¯æ¨¡æ‹Ÿ\userdata_mini
QMT_SESSION_ID=13579
QMT_ACCOUNT_ID=55012417

# é£æ§
MAX_ORDER_VALUE=100000
MIN_ORDER_QUANTITY=100
```

### 4ï¸âƒ£ å¯åŠ¨æœåŠ¡

```bash
# å…ˆå¯åŠ¨ QMT å®¢æˆ·ç«¯å¹¶ç™»å½•

# è¿è¡ŒæœåŠ¡
python main.py
```

æœåŠ¡å¯åŠ¨åè®¿é—®ï¼š`http://127.0.0.1:8000`

## ğŸŒ è¿œç¨‹éƒ¨ç½²

### äº‘æœåŠ¡å™¨ç‰ˆï¼ˆè¶…ç®€å•ï¼‰â­æ¨è

**é€‚ç”¨åœºæ™¯ï¼š**Windows äº‘æœåŠ¡å™¨ + Mac æœ¬åœ° Claude Desktop

**ä¸‰æ­¥æå®šï¼š**

1. **äº‘æœåŠ¡å™¨é…ç½® .envï¼š**
```env
QMT_PATH=ä½ çš„QMTè·¯å¾„
```

2. **å¼€æ”¾å®‰å…¨ç»„ç«¯å£ï¼š**TCP 8000

3. **Mac ä¸Šé…ç½®ï¼š**
```json
{
  "mcpServers": {
    "qmt-mcp": {
      "type": "sse",
      "url": "http://ä½ çš„äº‘æœåŠ¡å™¨å…¬ç½‘IP:8000/sse",
      "timeout": 60
    }
  }
}
```

å®Œæ•´æ•™ç¨‹ï¼š[CLOUD_SETUP.md](CLOUD_SETUP.md) ğŸ“–

### å±€åŸŸç½‘ç‰ˆï¼ˆå†…ç½‘åœºæ™¯ï¼‰

**é€‚ç”¨åœºæ™¯ï¼š**Mac æœ¬åœ°ä½¿ç”¨ Claude Desktopï¼Œè¿œç¨‹è¿æ¥åˆ°å±€åŸŸç½‘ Windows æœåŠ¡å™¨

### Windows æœåŠ¡å™¨ç«¯é…ç½®

1. **ä¿®æ”¹ .env æ–‡ä»¶å¯ç”¨è¿œç¨‹è®¿é—®ï¼š**
```env
QMT_HOST=127.0.0.1
QMT_PORT=8000
```

2. **é…ç½®é˜²ç«å¢™ï¼š**
```powershell
# å…è®¸ 8000 ç«¯å£å…¥ç«™ï¼ˆWindowsé˜²ç«å¢™ï¼‰
New-NetFirewallRule -DisplayName "QMT-MCP" -Direction Inbound -Protocol TCP -LocalPort 8000 -Action Allow
```

3. **å¯åŠ¨æœåŠ¡ï¼š**
```bash
python main.py
```

æœåŠ¡å¯åŠ¨åä¼šæ˜¾ç¤ºï¼š
```
âœ“ MCPæœåŠ¡å¯åŠ¨: http://0.0.0.0:8000 (è¿œç¨‹è®¿é—®æ¨¡å¼)
âš  è¿œç¨‹è®¿é—®å·²å¯ç”¨ï¼è¯·ç¡®ä¿ç½‘ç»œå®‰å…¨ï¼Œå»ºè®®ä½¿ç”¨VPNæˆ–SSHéš§é“
```

### Mac å®¢æˆ·ç«¯é…ç½®

åœ¨ Mac ä¸Šçš„ Claude Desktop é…ç½®ä¸­ä½¿ç”¨ Windows æœåŠ¡å™¨ IPï¼š

```json
{
  "mcpServers": {
    "qmt-mcp": {
      "type": "sse",
      "url": "http://ä½ çš„WindowsæœåŠ¡å™¨IP:8000/sse",
      "timeout": 60
    }
  }
}
```

## ğŸ”§ MCP å·¥å…·åˆ—è¡¨

### 1. `find_limit_up()` - æŸ¥æ‰¾æ¶¨åœæ¿
å‘ç°å½“æ—¥æ¶¨åœè‚¡ç¥¨ï¼Œè‡ªåŠ¨æŒ‰æ¶¨å¹…æ’åº

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
ğŸ“Š æ¶¨åœæ¿ç»Ÿè®¡ï¼ˆå…±15åªï¼‰
==================================================
1. 300123.SZ    +10.02%  æˆäº¤é‡: 15,234,567
2. 600456.SH    + 9.98%  æˆäº¤é‡: 23,456,789
...
```

### 2. `find_volume_surge(threshold)` - æˆäº¤é‡å¼‚åŠ¨
æŸ¥æ‰¾é‡æ¯”è¶…è¿‡é˜ˆå€¼çš„è‚¡ç¥¨

**å‚æ•°ï¼š**
- `threshold`: é‡æ¯”é˜ˆå€¼ï¼ˆé»˜è®¤2.0å€ï¼‰

**ç¤ºä¾‹ï¼š**
```python
find_volume_surge(threshold=3.0)  # æŸ¥æ‰¾é‡æ¯”è¶…è¿‡3å€çš„è‚¡ç¥¨
```

### 3. `get_stock_info(symbol, days)` - è‚¡ç¥¨è¯¦æƒ…
è·å–è‚¡ç¥¨å®Œæ•´ä¿¡æ¯ï¼šä»·æ ¼ã€æˆäº¤é‡ã€å‡çº¿ç­‰

**å‚æ•°ï¼š**
- `symbol`: è‚¡ç¥¨ä»£ç ï¼ˆå¦‚ 000001.SZï¼‰
- `days`: æŸ¥è¯¢å¤©æ•°ï¼ˆé»˜è®¤30å¤©ï¼‰

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
ğŸ“Š è‚¡ç¥¨ä¿¡æ¯: 000001.SZ
==================================================
æœ€æ–°ä»·æ ¼: Â¥10.50  (+2.15%)
ä»Šæ—¥åŒºé—´: Â¥10.20 - Â¥10.68
æˆäº¤é‡:   12,345,678
é‡æ¯”:     2.35x

å‡çº¿ç³»ç»Ÿ:
  MA5:  Â¥10.32
  MA20: Â¥9.87
```

### 4. `analyze_dragon_tiger(symbol)` - é¾™è™æ¦œåˆ†æ
åŸºäºæ¶¨å¹…å’Œæˆäº¤é‡åˆ¤æ–­ä¸Šæ¦œå¯èƒ½æ€§

**å‚æ•°ï¼š**
- `symbol`: è‚¡ç¥¨ä»£ç 

### 5. `place_order(symbol, quantity, price, direction)` - ä¸‹å•
æ‰§è¡Œä¹°å…¥æˆ–å–å‡ºäº¤æ˜“

**å‚æ•°ï¼š**
- `symbol`: è‚¡ç¥¨ä»£ç 
- `quantity`: æ•°é‡ï¼ˆå¿…é¡»æ˜¯100çš„æ•´æ•°å€ï¼‰
- `price`: ä»·æ ¼
- `direction`: BUYï¼ˆä¹°å…¥ï¼‰æˆ– SELLï¼ˆå–å‡ºï¼‰

### 6. `cancel_order(order_id)` - æ’¤å•
æ’¤é”€æŒ‡å®šè®¢å•

**å‚æ•°ï¼š**
- `order_id`: è®¢å•å·

## ğŸ”Œ Claude Desktop é›†æˆ

### æœ¬åœ°æ¨¡å¼ï¼ˆåŒä¸€å°æœºå™¨ï¼‰

åœ¨ Claude Desktop é…ç½®ä¸­æ·»åŠ ï¼ˆæ¨è SSE ç›´è¿ï¼‰ï¼š

```json
{
  "mcpServers": {
    "qmt-mcp": {
      "type": "sse",
      "url": "http://127.0.0.1:8000/sse",
      "timeout": 60
    }
  }
}
```

æˆ–ä½¿ç”¨å‘½ä»¤å¯åŠ¨æ¨¡å¼ï¼š

```json
{
  "mcpServers": {
    "qmt-mcp": {
      "command": "python",
      "args": ["path/to/qmt-mcp/main.py"]
    }
  }
}
```

### è¿œç¨‹æ¨¡å¼ï¼ˆMac è¿æ¥ Windows æœåŠ¡å™¨ï¼‰

```json
{
  "mcpServers": {
    "qmt-mcp": {
      "type": "sse",
      "url": "http://ä½ çš„WindowsæœåŠ¡å™¨IP:8000/sse",
      "timeout": 60
    }
  }
}
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

åœ¨ Claude Desktop ä¸­ç›´æ¥å¯¹è¯ï¼š

```
ğŸ‘¤ å¸®æˆ‘æŸ¥ä¸€ä¸‹ä»Šå¤©æœ‰å“ªäº›æ¶¨åœè‚¡ç¥¨

ğŸ¤– [è°ƒç”¨ find_limit_up()]
ğŸ“Š æ¶¨åœæ¿ç»Ÿè®¡ï¼ˆå…±12åªï¼‰...

ğŸ‘¤ æŸ¥ä¸€ä¸‹ 000001.SZ çš„è¯¦ç»†ä¿¡æ¯

ğŸ¤– [è°ƒç”¨ get_stock_info("000001.SZ")]
ğŸ“Š è‚¡ç¥¨ä¿¡æ¯: 000001.SZ...

ğŸ‘¤ æ‰¾ä¸€ä¸‹é‡æ¯”è¶…è¿‡3å€çš„è‚¡ç¥¨

ğŸ¤– [è°ƒç”¨ find_volume_surge(3.0)]
ğŸ“ˆ æˆäº¤é‡å¼‚åŠ¨ï¼ˆé‡æ¯”>=3å€ï¼‰...
```

## ğŸ›¡ï¸ é£æ§æœºåˆ¶

- âœ… å•ç¬”è®¢å•é‡‘é¢é™åˆ¶ï¼ˆMAX_ORDER_VALUEï¼‰
- âœ… æœ€å°ä¸‹å•æ•°é‡æ§åˆ¶ï¼ˆ100è‚¡æ•´æ•°å€ï¼‰
- âœ… å‚æ•°ä¸¥æ ¼éªŒè¯
- âœ… æ¨¡æ‹Ÿæ¨¡å¼æ”¯æŒï¼ˆæ—  XTQuant ä¹Ÿå¯æµ‹è¯•ï¼‰

## ğŸ“ ä»£ç ç»“æ„ï¼ˆmain.pyï¼‰

```python
# é…ç½®ç®¡ç†
class Config: ...

# XTQuantå®¢æˆ·ç«¯
class XTQuantClient:
    - connect()          # è¿æ¥
    - get_market_data()  # è·å–è¡Œæƒ…
    - get_sector_data()  # è·å–æ¿å—æ•°æ®
    ...

# äº¤æ˜“å·¥å…·
class TradingTools:
    - place_order()      # ä¸‹å•
    - cancel_order()     # æ’¤å•
    ...

# æ•°æ®åˆ†æ
class DataAnalyzer:
    - find_limit_up_stocks()   # æ¶¨åœæ¿
    - find_volume_surge()      # é‡å¼‚åŠ¨
    - get_stock_info()         # è‚¡ç¥¨ä¿¡æ¯
    - analyze_dragon_tiger()   # é¾™è™æ¦œ
    ...

# MCPæœåŠ¡
@mcp.tool()
def find_limit_up(): ...
```

## â“ å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆé€‰æ‹©å•æ–‡ä»¶æ¶æ„ï¼Ÿ**
A: ç®€å•æ˜“è¯»ï¼Œæ–¹ä¾¿ç†è§£å’Œä¿®æ”¹ï¼Œæ— éœ€åœ¨å¤šä¸ªæ–‡ä»¶é—´è·³è½¬ã€‚

**Q: XTQuant è¿æ¥å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
A: ç¡®ä¿ QMT å®¢æˆ·ç«¯å·²å¯åŠ¨å¹¶ç™»å½•ï¼Œæ£€æŸ¥ .env ä¸­çš„ QMT_PATH æ˜¯å¦æ­£ç¡®ã€‚

**Q: å¯ä»¥ä¸ç”¨ XTQuant å—ï¼Ÿ**
A: å¯ä»¥ï¼Œä»£ç ä¼šè‡ªåŠ¨è¿›å…¥æ¨¡æ‹Ÿæ¨¡å¼ï¼Œä½†éƒ¨åˆ†æ•°æ®åŠŸèƒ½å°†ä¸å¯ç”¨ã€‚

**Q: å¦‚ä½•æ‰©å±•æ–°åŠŸèƒ½ï¼Ÿ**
A: ç›´æ¥åœ¨ `main.py` ä¸­æ·»åŠ æ–°çš„å·¥å…·å‡½æ•°ï¼Œå¹¶ç”¨ `@mcp.tool()` è£…é¥°å™¨æ³¨å†Œå³å¯ã€‚

## ğŸ“š ç›¸å…³èµ„æº

- [FastMCP æ–‡æ¡£](https://github.com/jlowin/fastmcp)
- [XTQuant API æ–‡æ¡£](https://dict.thinktrader.net/nativeApi/start_now.html)
- [Model Context Protocol](https://modelcontextprotocol.io/)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ“§ è”ç³»æ–¹å¼

- GitHub: [@stdeson](https://github.com/stdeson)
- Email: stdeson@gmail.com

---

**ğŸŒŸ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Starï¼**
